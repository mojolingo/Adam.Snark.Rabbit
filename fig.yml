mongo:
  image: dockerfile/mongodb
  volumes:
    - ./mongo:/data

xmpp:
  image: quay.io/mojolingo/adam_xmpp_server
  ports:
    - "5222:5222"
    - "5269:5269"
    - "5280:5280"
  environment:
    ERL_OPTIONS: "-noshell"
    XMPP_DOMAIN: local.adamrabbit.net
    MEMORY_BASE_URL: http://local.adamrabbit.net
    INTERNAL_USERNAME: internal
    INTERNAL_PASSWORD: fj8j4893jgg9jg9

brain:
  build: brain
  volumes:
    - ./brain:/app
  links:
    - xmpp
  environment:
    ADAM_FINGERS_JID: adam@local.adamrabbit.net
    ADAM_FINGERS_PASSWORD: abc123
    ADAM_FINGERS_DEBUG: true

memory:
  build: memory
  volumes:
    - ./memory:/app
  links:
    - mongo
  ports:
    - "3000:3000"
  environment:
    PORT: 3000
    ADAM_ROOT_DOMAIN: local.adamrabbit.net
    MONGOID_HOST: mongo_1
    ADAM_MEMORY_URL: http://local.adamrabbit.net
    ADAM_MEMORY_INTERNAL_USERNAME: internal
    ADAM_MEMORY_INTERNAL_PASSWORD: fj8j4893jgg9jg9
